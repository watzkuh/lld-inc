# RUN: rm -rf %t.dir
# RUN: mkdir %t.dir
# RUN: yaml2obj < %p/Inputs/extern-data.yaml > %t.dir/extern-data.obj
# RUN: yaml2obj < %p/Inputs/function.yaml > %t.dir/function.obj
# RUN: lld-link /out:%t.dir/inc.exe /entry:main /nodefaultlib /incrementallink %t.dir/extern-data.obj %t.dir/function.obj | FileCheck %s

CHECK: No incremental

# RUN: yaml2obj < %p/Inputs/extern-data-modified.yaml > %t.dir/extern-data.obj
# RUN: lld-link /out:%t.dir/inc.exe /entry:main /nodefaultlib /incrementallink %t.dir/extern-data.obj %t.dir/function.obj | FileCheck --check-prefix=INC %s

INC: Attempting incremental link
INC-NOT: function.obj has changed
INC-NEXT: extern-data.obj has changed
INC-NEXT: Rewriting .data section