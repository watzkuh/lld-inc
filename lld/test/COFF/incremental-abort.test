# RUN: rm -rf %t.dir
# RUN: mkdir %t.dir && cd %t.dir
# RUN: LDFLAGS="/out:inc.exe /opt:noref /entry:main /nodefaultlib /incremental"
# RUN: yaml2obj %p/Inputs/extern-data.yaml > extern-data.obj
# RUN: yaml2obj %p/Inputs/function.yaml > function.obj
# RUN: env LLD_IN_TEST=1 lld-link $LDFLAGS extern-data.obj function.obj | FileCheck %s

CHECK: No incremental

# RUN: yaml2obj %p/Inputs/extern-data-large.yaml > extern-data.obj
# RUN: env LLD_IN_TEST=1 lld-link $LDFLAGS extern-data.obj function.obj | FileCheck --check-prefix=INC %s

INC: Attempting incremental link
INC: New .data section in
INC-NEXT: New: 384
INC: Incremental link aborted

# RUN: yaml2obj %p/Inputs/extern-data.yaml > extern-data.obj
# RUN: env LLD_IN_TEST=1 lld-link $LDFLAGS extern-data.obj function.obj | FileCheck --check-prefix=SHRINK %s

SHRINK: Attempting incremental link
SHRINK: New .data section in
SHRINK: New: 128
SHRINK: Incremental link aborted